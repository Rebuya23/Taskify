<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Taskify</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: white;
    color: black;
  }

  input, button {
    padding: 5px 10px;
    margin: 2px;
  }

  button.add { background:#4CAF50; color:white; }
  button.sort { background:#2196F3; color:white; }
  button.reset { background:#FFC107; color:black; }
  button.delete { background:#F44336; color:white; }
  button.theme { background:#9E9E9E; color:white; }

  ul { padding-left:0; }
  li { list-style:none; margin:5px 0; }
  li span { margin-left:5px; }

  li.done span { text-decoration:line-through; color:gray; }
</style>
</head>

<body>

<h2>Taskify</h2>
<p>A Simple Task Manager</p>
<p>Created by: <b>Aljomar M. Rebuya BSIT 2D</b></p>

<input type="text" id="taskInput" placeholder="Enter task">
<button class="add" onclick="addTask()">+</button>

<br><br>

<button class="sort" onclick="sortAZ()">Sort A-Z</button>
<button class="sort" onclick="sortZA()">Sort Z-A</button>
<button class="reset" onclick="resetTasks()">Reset</button>
<button class="theme" onclick="toggleTheme()">Theme</button>

<ul id="taskList"></ul>

<p>
Total Tasks: <span id="total">0</span> |
Completed: <span id="completed">0</span> |
Deleted: <span id="deleted">0</span> |
Edited: <span id="edited">0</span>
</p>

<script>
let deleted = 0;
let edited = 0;
let originalTasks = [];

const input = document.getElementById("taskInput");
const list = document.getElementById("taskList");

input.addEventListener("keydown", e=>{
  if(e.key==="Enter") addTask();
});

function addTask(textFromReset=null){
  const text = textFromReset ?? input.value.trim();

  if(text===""){
    alert("Empty task!");
    return;
  }

  // duplicate check
  for(let li of list.children){
    const t = li.querySelector("span").textContent.trim();
    if(t === text){
      alert("Duplicate task!");
      return;
    }
  }

  const li = document.createElement("li");

  const check = document.createElement("input");
  check.type="checkbox";
  check.onchange=()=>{
    li.classList.toggle("done",check.checked);
    updateCounts();
  };

  const span = document.createElement("span");
  span.textContent=text;
  span.ondblclick=()=>editTask(span);

  const del = document.createElement("button");
  del.className="delete";
  del.textContent="X";
  del.onclick=()=>{
    if(confirm("Delete this task?")){
      li.remove();
      deleted++;
      updateCounts();
    }
  };

  li.appendChild(check);
  li.appendChild(span);
  li.appendChild(del);
  list.appendChild(li);

  // ONLY save to original if user added it manually
  if(textFromReset===null){
    originalTasks.push(text);
    input.value="";
  }

  updateCounts();
}

function editTask(span){
  const oldText = span.textContent.trim();
  const newText = prompt("Edit task:",oldText);

  if(!newText || newText.trim()==="" || newText===oldText) return;

  span.textContent=newText.trim();
  edited++;
  updateCounts();
}

function updateCounts(){
  document.getElementById("total").textContent=list.children.length;
  document.getElementById("completed").textContent=
    document.querySelectorAll("#taskList input[type=checkbox]:checked").length;
  document.getElementById("deleted").textContent=deleted;
  document.getElementById("edited").textContent=edited;
}

function sortAZ(){
  [...list.children]
    .sort((a,b)=>
      a.querySelector("span").textContent
      .localeCompare(b.querySelector("span").textContent)
    )
    .forEach(li=>list.appendChild(li));
}

function sortZA(){
  [...list.children]
    .sort((a,b)=>
      b.querySelector("span").textContent
      .localeCompare(a.querySelector("span").textContent)
    )
    .forEach(li=>list.appendChild(li));
}

function resetTasks(){
  list.innerHTML="";
  originalTasks.forEach(t=>addTask(t));
}

function toggleTheme(){
  if(document.body.style.background==="black"){
    document.body.style.background="white";
    document.body.style.color="black";
  }else{
    document.body.style.background="black";
    document.body.style.color="white";
  }
}
</script>

</body>
</html>
